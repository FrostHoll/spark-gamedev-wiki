
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/FrostHoll/spark-gamedev-wiki/learn/lvl_2/2_3_patterns_basics/">
      
      
        <link rel="prev" href="../2_2_coroutines/">
      
      
        <link rel="next" href="../2_4_unity_events/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>2.3 Паттерны проектирования. Часть 1 - Spark GameDev Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#23-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Spark GameDev Wiki" class="md-header__button md-logo" aria-label="Spark GameDev Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spark GameDev Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2.3 Паттерны проектирования. Часть 1
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Главная

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../team/team_index/" class="md-tabs__link">
          
  
  
  Наша команда

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../project/project_index/" class="md-tabs__link">
          
  
  
  Проект

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../rules/rules_index/" class="md-tabs__link">
          
  
  
  Правила

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../guides/installation/" class="md-tabs__link">
          
  
  
  Гайды

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../learn_index/" class="md-tabs__link">
          
  
  
  Материалы для изучения

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Spark GameDev Wiki" class="md-nav__button md-logo" aria-label="Spark GameDev Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Spark GameDev Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Главная
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Наша команда
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Наша команда
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/team_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Наша команда
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/meetings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Встречи
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/hall_of_fame/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Доска почета
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.google.com/spreadsheets/d/10h4VtALQuqD2I97SMZjRGgB_mbOLreOIRDi3-VYRbuI/edit?usp=sharing" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Сводка
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Личные дела
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Личные дела
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Hasan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Хасан
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Alexander/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Александр
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Rustem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Рустем
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Dinar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Динар
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Vladimir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Владимир
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Alexey/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Алексей
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Adelina/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Аделина
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../team/files/Renata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Рената
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Проект
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Проект
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../project/project_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Проект
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../project/mvp_reqs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    О MVP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Правила
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Правила
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rules/rules_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Правила
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rules/lyrical_degression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Лирическое отступление
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rules/format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Формат
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rules/terms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Термины и Звания
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rules/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ответы на частые вопросы
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Гайды
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Гайды
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Установка программ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Кто такой этот ваш Git
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/strive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Работа со Strive
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Материалы для изучения
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Материалы для изучения
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learn_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Материалы
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    1-й уровень
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            1-й уровень
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lvl_1/metanit_csharp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    База C# Metanit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lvl_1/1_1_sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.1 Сортировка сериалов
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lvl_1/1_2_unity_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.2 Поверхность Unity
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" checked>
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2-й уровень
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            2-й уровень
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OOP_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    База ООП
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_1_abstracts_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.1 Абстрактные классы и интерфейсы
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_2_coroutines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.2 Корутины
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    2.3 Паттерны проектирования. Часть 1
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    2.3 Паттерны проектирования. Часть 1
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      Введение
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#singleton" class="md-nav__link">
    <span class="md-ellipsis">
      Одиночка (Singleton)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Одиночка (Singleton)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      Описание
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Реализации
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Итог
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observer" class="md-nav__link">
    <span class="md-ellipsis">
      Наблюдатель (Observer)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Наблюдатель (Observer)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      Описание
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      Реализации
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      Итог
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#facade" class="md-nav__link">
    <span class="md-ellipsis">
      Фасад (Facade)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Фасад (Facade)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      Описание
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      Реализации
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      Итог
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      Заключение
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      Задание
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_4_unity_events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.4 События в Unity
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    3-й уровень
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            3-й уровень
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lvl_3/solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SOLID
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    4-й уровень
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            4-й уровень
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lvl_4/best_practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Хорошие практики
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      Введение
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#singleton" class="md-nav__link">
    <span class="md-ellipsis">
      Одиночка (Singleton)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Одиночка (Singleton)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      Описание
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Реализации
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Итог
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observer" class="md-nav__link">
    <span class="md-ellipsis">
      Наблюдатель (Observer)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Наблюдатель (Observer)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      Описание
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      Реализации
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      Итог
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#facade" class="md-nav__link">
    <span class="md-ellipsis">
      Фасад (Facade)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Фасад (Facade)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      Описание
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      Реализации
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      Итог
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      Заключение
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      Задание
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="23-1">2.3 Паттерны проектирования. Часть 1</h1>
<p>Сегодня мы с вами посмотрим, что такое паттерны проектирования вообще, и рассмотрим несколько базовых, от которых можно отталкиваться.</p>
<h2 id="_1">Введение</h2>
<p>Как говорится, позвольте мне краткую историческую справку.</p>
<p>В 1977 году Кристофер Александер, дизайнер и архитектор, выпускает книгу <strong>"A Pattern Language"</strong>, в которой рассказывает о том, как повторяющиеся решения типовых задач можно быстро и удобно переиспользовать в новых проектах. Хотя он и никак не относился к программированию, но слово архитектура вы слышите здесь не в первый раз, так ведь?</p>
<p>Так вот, группа гениальных программистов через десять с небольшим лет очень вдохновились идеей Александера, и в итоге в 1994 году на свет появилась книга <strong>"Design Patterns: Elements of Reusable Object-Oriented Software"</strong>. Вылезла она из под рук <strong>"Банды четырех"</strong>: Эрих Гамма, Ричард Хелм, Ральф Джонсон, Джон Влиссидес. Имена запоминать необязательно, главное помнить "Банду четырех", чтобы не сильно позориться перед программистами высшего звена.</p>
<p>Книга описывала решения типовых задач, которые появляются при проектировании архитектуры приложений. Эти решения, которых книга насчитывала аж 23 штуки, впоследствии назовут паттернами проектирования, или просто паттернами, а затем этот список будет стремительно разрастаться с годами.</p>
<p>Сейчас паттерны проектирования - активно расширяющийся "фандом", и их сейчас куда больше, но они не относятся к "канону". Тот же MVC, с которым вы уже знакомы, является таковым - по сути апокриф к паттернам проектирования (простите за библейскую аллегорию). И если программист на вопрос "на каких языках ты программируешь", отвечает хотя бы один ООП язык, и при этом не знает хотя бы половины из паттернов - его резюме даже не рассматривают.</p>
<p><strong>Почему они настолько важны?</strong></p>
<ul>
<li>У паттернов указаны условия и области применения. Они помогают намного быстрее найти решение и начать реализацию, если задача достаточно типовая.</li>
<li>Вряд ли под словом "машина", два разных человека будут иметь кардинально разное понимание, что это такое. Примерно такое и работает с паттернами: если вы применяете в своем решении паттерн, то все, кто с ним знаком, легко поймут, что здесь и к чему. Это сильно упрощает разработку в команде.</li>
<li>Если вы будете сильно сильно думать, как решить типовую архитектурную задачу, вы рано или поздно все равно придете к одному из паттернов. А он еще и продуман намного лучше, и, заметьте, он еще и в два раза старше вас. И при этом не претерпел никаких изменений. Это явно о чем-то говорит.</li>
<li>Решения этих задач, на удивление, опередили SOLID, а они этим принципам идеально придерживаются: при правильном применении паттернов код гарантированно получится чистым и расширяемым.</li>
</ul>
<p>Вообще по канону паттерны распределены на три типа:</p>
<ol>
<li><strong>Порождающие (Creational)</strong> - задачи, которые возникают при создании объектов разных типов, и поддержанию их правильной связности.</li>
<li><strong>Поведенческие (Behavioral)</strong> - задачи, которые возникают при описании логики поведения объектов, смены логики и так далее.</li>
<li><strong>Структурные (Structural)</strong> - задачи, которые возникают при необходимости представить один класс через другой, разграничить связность, восстановить структуру объектов.</li>
</ol>
<p>Сейчас мы с вами разберем по одному паттерну из каждого типа, которые вам с большой вероятностью пригодятся в нашем проекте. Другие, менее популярные, будут описаны в дальнейшем, в другой статье, которая выйдет уже на 3-м уровне. (если ссылки пока нет - статья пока не написана)</p>
<h2 id="singleton">Одиночка (Singleton)</h2>
<p>Один в поле - не воин. А вот он воин, и еще какой!</p>
<h3 id="_2">Описание</h3>
<p>Паттерн Одиночка - порождающий паттерн, который определяет класс, у которого может быть только один экземпляр, и одну глобальную точку доступа к нему.</p>
<p>Это <strong>самый простой</strong> паттерн проектирования из существующих. И при этом его повсеместное применение - крайне осуждается. Давайте разберем сначала когда его используют:</p>
<ul>
<li>Когда у какого-то класса может быть только один экземпляр, которым могут пользоваться кто угодно, в любой части приложения.</li>
<li>Для описания и хранения глобальных переменных.</li>
</ul>
<h3 id="_3">Реализации</h3>
<p>Итак, работает он через статическое поле, и его классическая реализация выглядит таким образом:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Singleton</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">s_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">GetInstance</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s_instance</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="w">            </span><span class="n">s_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Singleton</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">s_instance</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Поле экземпляра (<code>s_instance</code>) - статическое, значит существует все время. Через статический метод <code>GetInstance</code> мы получаем ссылку на этот единственный экземпляр и работаем с ним так, как хотим. </p>
<p>С точки зрения Unity реализация Одиночки выглядит таким образом:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Singleton</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">MonoBehavior</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="n">s_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Singleton</span><span class="w"> </span><span class="nf">GetInstance</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s_instance</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">s_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">GameObject</span><span class="p">()).</span><span class="n">AddComponent</span><span class="o">&lt;</span><span class="n">Singleton</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">            </span><span class="n">DontDestroyOnLoad</span><span class="p">(</span><span class="n">s_instance</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">s_instance</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Так как Одиночка здесь компонент, то немного отличается его создание на сцене, а также он засовывается в метод <code>DontDestroyOnLoad</code>, что исключает его из объектов для удаления при смене сцены - после его создания он будет существовать в игре до конца работы.</p>
<p>Есть чуть попроще реализация, которая позволяет настраивать поля Одиночки в редакторе. Мы навешиваем скрипт на пустой объект на самой первой сцене, что дает нам возможность редактировать поля, а код уже изменится. Давайте рассмотрим на примере реализации Одиночки из моего проекта:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">TooltipController</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">MonoBehaviour</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">TooltipController</span><span class="w"> </span><span class="n">s_instance</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">TooltipController</span><span class="w"> </span><span class="n">Instance</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s_instance</span><span class="p">;</span>

<span class="w">    </span><span class="na">[SerializeField]</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="n">Tooltip</span><span class="w"> </span><span class="n">_tooltip</span><span class="p">;</span>

<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Awake</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s_instance</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">Destroy</span><span class="p">(</span><span class="n">gameObject</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">s_instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<span class="w">        </span><span class="n">DontDestroyOnLoad</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ShowTooltip</span><span class="p">(</span><span class="n">Tooltipable</span><span class="w"> </span><span class="n">tooltipable</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// показать подсказку</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// использование</span>
<span class="n">TooltipController</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="n">ShowTooltip</span><span class="p">(...);</span>
</code></pre></div>
<p>Этот класс отвечает за появление подсказки при наведении на объекты. Я определяю объект подсказки <code>Tooltip</code> в редакторе, а затем через экземпляр спокойно работаю с ним, например, через метод <code>ShowTooltip</code>. Как видите, инициализация Одиночки перенесена в метод <code>Awake</code>, и если существует еще один Одиночка того же типа, то он уничтожается (это нужно, когда один и тот же компонент есть на разных сценах). Заметьте, что доступ к экземпляру описан через свойство, что не защищено от <code>NullReferenceException</code>. Можно было бы объединить эту реализацию с предыдущей, чтобы добиться идеала.</p>
<h3 id="_4">Итог</h3>
<p>Я уже сказал, что его повсеместное использование крайне осуждается. <strong>Особенно в Unity</strong>. Почему?</p>
<p>Ну вот подумайте. Вот есть у нас на сцене объектик, который, допустим, открывает дверь, только когда у игрока меньше 30% здоровья. Этот объект является частью дизайна уровней, а потому ему будет сложно задать ссылку на игрока (сцены загружаются динамически, поэтому игрока на них не будет). Поэтому что? Правильно - давайте сделаем игрока Одиночкой, ведь игрок всегда один, правда? Тогда этому объекту достаточно будет просто обратиться к статической ссылке и все прекрасно!</p>
<p>Замечаете? Как только у вас встречается проблема с получением ссылки на один единственный, не очень удобный объект, так и напрашивается Одиночка. Вот только повсеместное использование этого приносит огромное количество проблем: если не заглянем в код этого объекта, мы и не узнаем, что ему нужен игрок. Это убирает возможность протестировать его функционал без игрока. Появляется сильная связь. Причем сильная <strong>незаметная</strong> связь, что является проблемой в квадрате.</p>
<p>Пока мы еще на этой проблеме, подмечу еще одно решение, которое частенько у вас приходит в голову. Это <code>FindObjectByType</code>. Это абсолютно то же самое, только нам не нужно целевой объект делать Одиночкой. Взамен, мы должны дождаться, пока он проверит <strong>все объекты на сцене</strong>, а у каждого из них проверит <strong>все компоненты</strong>. Вы будете в шоке, когда узнаете сколько <strong>секунд</strong> это занимает на больших сценах. А это только один единственный вызов! А если вы везде будете такое пихать? <em>Ох мама...</em> </p>
<p>Поэтому если и делаете плохо - хотя бы делайте это с честью. Так вы хотя бы получите небольшой респект за то, что воспользовались паттерном, а не вонючим костылем.</p>
<h2 id="observer">Наблюдатель (Observer)</h2>
<p>Большой брат следит за вами. И он говорит вам: "пора браться за работу!"</p>
<h3 id="_5">Описание</h3>
<p>Паттерн Наблюдатель - поведенческий паттерн, который определяет связь "один ко многим" между наблюдаемым объектом и наблюдателями. При изменении наблюдаемого объекта все наблюдатели узнают об изменении.</p>
<p>Его используют когда:</p>
<ul>
<li>Система состоит из множества классов, объекты которых должны находиться в согласованных отношениях (один ко многим).</li>
<li>Взаимодействие между объектами имеет характер "событие - обработчики события".</li>
</ul>
<h3 id="_6">Реализации</h3>
<p>Работает паттерн через делегаты и события (частными случаями делегатов), с которыми вы можете ближе познакомиться <a href="../2_4_unity_events/">в этой статье</a>, написанной Хасаном.</p>
<p>Классическая реализация, без делегатов, выглядит таким образом:</p>
<div class="highlight"><pre><span></span><code><span class="k">interface</span><span class="w"> </span><span class="n">IObserver</span><span class="w"> </span><span class="c1">// наблюдатель</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">interface</span><span class="w"> </span><span class="n">IObservable</span><span class="w"> </span><span class="c1">// наблюдаемый объект</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">void</span><span class="w"> </span><span class="nf">AddObserver</span><span class="p">(</span><span class="n">IObserver</span><span class="w"> </span><span class="n">o</span><span class="p">);</span>

<span class="w">    </span><span class="k">void</span><span class="w"> </span><span class="nf">RemoveObserver</span><span class="p">(</span><span class="n">IObserver</span><span class="w"> </span><span class="n">o</span><span class="p">);</span>

<span class="w">    </span><span class="k">void</span><span class="w"> </span><span class="nf">NotifyObservers</span><span class="p">(</span><span class="kt">object</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Суть в том, что наблюдаемый объект (<code>IObservable</code>) должен хранить список наблюдателей (<code>IObserver</code>). Через методы <code>AddObserver</code> и <code>RemoveObserver</code> добавлять и убирать наблюдателей из списка, а в методе <code>NotifyObservers</code> вызывать у каждого наблюдателя метод <code>Update</code>, который при желании можно дополнить любыми параметрами.</p>
<p>Однако таким образом для каждой системы "наблюдаемый объект-наблюдатели", нужно будет создавать отдельные интерфейсы, прописывать реализации. Это неудобно. Хотя отчасти такая система до сих пор используется в Unity, например при реализации интерфейсов <code>IPointerClickHandler</code> и других. Просто подписка скрыта от ваших глаз.</p>
<p>Сейчас лучше всего реализовывать данный паттерн через делегаты, или еще лучше через Action, UnityAction и UnityEvent. О их работе вы тоже можете ознакомиться <a href="../2_4_unity_events/">в этой статье</a>.</p>
<p>Давайте на примере небольшого кода из моего проекта:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ColorCell</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">MonoBehaviour</span><span class="p">,</span><span class="w"> </span><span class="n">IPointerClickHandler</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">event</span><span class="w"> </span><span class="n">UnityAction</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ColorClicked</span><span class="p">;</span><span class="w"> </span><span class="c1">// событие по выбору цвета</span>

<span class="w">    </span><span class="c1">// событие по клику мыши</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnPointerClick</span><span class="p">(</span><span class="n">PointerEventData</span><span class="w"> </span><span class="n">eventData</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_isSelected</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">_isDone</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="n">ColorClicked</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">_colorNum</span><span class="p">);</span><span class="w"> </span><span class="c1">// вызываем событие, что цвет изменен</span>
<span class="w">        </span><span class="n">SetSelected</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ColorPalleteController</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">MonoBehaviour</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">InitPallete</span><span class="p">(</span><span class="n">Color</span><span class="p">[]</span><span class="w"> </span><span class="n">colors</span><span class="p">)</span><span class="w"> </span><span class="c1">// создаем палетку</span>
<span class="w">    </span><span class="p">{</span><span class="w">            </span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">colors</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// создаем цвета</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Instantiate</span><span class="p">(</span><span class="n">_cellPrefab</span><span class="p">,</span><span class="w"> </span><span class="n">_palleteRoot</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// подписываемся на событие смены цвета</span>
<span class="w">            </span><span class="n">cell</span><span class="p">.</span><span class="n">ColorClicked</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">OnColorClicked</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnColorClicked</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">colorIndex</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// обрабатываем событие</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>У меня есть проект по раскраске картинок по пикселю. Там есть палетка цветов, и мне нужно менять цвет, которым мы рисуем, когда тыкаем по нужному цвету в палетке.</p>
<p>Здесь <code>ColorCell</code> - цвет на палетке, а <code>ColorPalleteController</code> - сама палетка с цветами. Заметьте, что тут используется и классическая реализация (<code>IPointerClickHandler</code> в <code>ColorCell</code>), и реализация через события - событие изменения выбранного цвета.</p>
<h3 id="_7">Итог</h3>
<p>Паттерн Наблюдатель - один из самых используемых паттернов в принципе, и он есть даже там, где вы раньше и не подозревали. Паттерн позволяет соединять объекты друг с другом, не создавая связи вообще (в случае событий), что позволяет на лету менять наблюдателей прямо во время работы. На основе этого паттерна существует отличный инструмент <code>EventBus</code>, до которого мы еще дойдем. А пока привыкайте его видеть, и, самое главное, использовать. При его реализации главное помнить - не удаляйте подписчиков во время обработки событий, и они обрабатывают события по порядку добавления их в список / делегат.</p>
<h2 id="facade">Фасад (Facade)</h2>
<p>Ну и последний на сегодня - Фасад.</p>
<h3 id="_8">Описание</h3>
<p>Паттерн Фасад - структурный паттерн, который призван скрывать сложность системы с помощью представления упрощенного интерфейса для взаимодействия с ней. Если проще: за фасадом мы скрываем огромную сложную систему, а работаем с ней только через фасад.</p>
<p>Его используют когда:</p>
<ul>
<li>Необходимо определить одну точку взаимодействия с системой.</li>
<li>Необходимо определить подсистемы компонентов в сложной системе.</li>
<li>Нужно уменьшить количество зависимостей между системой и клиентом.</li>
</ul>
<h3 id="_9">Реализации</h3>
<p>На самом деле это тоже один из простейших паттернов. Потому что идея, скрывать классы в другом, вам уже знакома. Да-да: MVC - частный случай Фасада.</p>
<p>Давайте взглянем на классическую реализацию:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Facade</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="n">SubsystemA</span><span class="w"> </span><span class="n">_subsystemA</span><span class="p">;</span>
<span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="n">SubsystemB</span><span class="w"> </span><span class="n">_subsystemB</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">Facade</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">_subsystemA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SubsystemA</span><span class="p">();</span>
<span class="w">        </span><span class="n">_subsystemB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SubsystemB</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Operation</span><span class="p">()</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">_subsystemA</span><span class="p">.</span><span class="n">Do</span><span class="p">();</span>
<span class="w">        </span><span class="n">_subsystemB</span><span class="p">.</span><span class="n">Do1</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SubsystemA</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Do</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SubsystemB</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Do1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Не уверен, нужно ли вообще здесь комментировать. Разве что нужно подметить, что все подсистемы, входящие в Фасад, должны быть скрыты, иначе смысл паттерна стирается.</p>
<p>Если уж говорить про MVC, то в нем <code>Controller</code> - Фасад. А <code>Model</code> и <code>View</code> - подсистемы. Клиенты взаимодействуют на подсистемы именно через Фасад (например чтобы уменьшить здоровье, что находится у <code>Model</code>, нужно вызвать метод из <code>Controller</code>, а не у <code>Model</code> напрямую).</p>
<h3 id="_10">Итог</h3>
<p>Этот паттерн вы, скорее всего, уже применяли где-то, и будете применять еще. Вы должны его знать, и <strong>правильно применять</strong>, потому что сокрытие подсистем - является важной частью написания кода.</p>
<h2 id="_11">Заключение</h2>
<p>Вообще один поведенческий паттерн мы уже смотрели в <a href="../../lvl_4/best_practices/#_2">хороших практиках</a> - Паттерн Стратегия. И реализовывали много. И еще предстоит пощупать многие на практике. Суть всего этого - видеть и применять стандарты. Потому что изобретать велосипед, безусловно, весело. Но вот пользоваться тем, что уже давно за вас придумали - полезно и удобно. Далее нас ждут еще более веселые и сложные паттерны, которые, кстати, вы можете глянуть в любой момент времени. Правда обычно там все написано тяжелым техническим языком, а тут я попытался для вас немного упростить представление, с учетом реализаций применимых к Unity.</p>
<h2 id="_12">Задание</h2>
<p>Без написания хотя бы одного из этих паттернов вы вряд ли обойдетесь. Поэтому ваша задача - научиться их видеть, и в любой момент времени, если я спрошу о них, вы должны показать и объяснить, что вы тут использовали. Это и есть ваше задание.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "search.highlight", "search.suggest"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>